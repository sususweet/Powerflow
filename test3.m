Sb=100; 
Ub2=121;
Ub1=10.5;
Ub=110;
Zb=Ub^2/Sb;
Yb=1/Zb;

% 节点参数
% (bus#)( volt )( ang )(  p )(  q )(bus type)(是否机组1是0否)(Xd'')
bus = [ 1 1.00    0.00  -0.35  -0.18      1   0   0.000;
	    2 1.00    0.00  -0.30  -0.16      1   0   0.000;
	    3 1.00    0.00  -0.40  -0.20      1   0   0.000;
	    4 1.00    0.00  -0.25  -0.12      1   0   0.000;
	    5 1.00    0.00  -0.20  -0.10      1   0   0.000;
	    6 1.00    0.00  -0.15  -0.06      1   0   0.000;
	    7 1.05    0.00   0.40   0.00      2   1   0.000265;
	    8 1.05    0.00   0.45   0.00      2   1   0.000265;
	    9 1.05    0.00   0.00   0.00      3   1   0.000265];

% line data format
% line: from bus, to bus, resistance(pu), reactance(pu),
%       line charging(pu), tap ratio

% line = [2,5,0.00676652892561984,0.0206611570247934,0,0.0180290000000000,0;
%         1,4,0.0135330578512397,0.0413223140495868,0,0.0360580000000000,0;
%         1,6,0.00976239669421488,0.0365392561983471,0,0.0331056000000000,0;
%         3,5,0.00811983471074380,0.0247933884297521,0,0.0216348000000000,0;
%         3,6,0.00759297520661157,0.0284194214876033,0,0.0257488000000000,0;
%         2,4,0.00541322314049587,0.0165289256198347,0,0.0144232000000000,0;
%         4,7,0.0109297520661157,0.229524793388430,0.000503213610586011,-0.00686200378071834,1;
%         6,9,0.00700187241735537,0.143452995867769,0.000896635160680529,-0.0109792060491493,1;
%         5,8,0.0109297520661157,0.229524793388430,0.000503213610586011,-0.00686200378071834,1]


line = [ 2 5  0.131   0.400      0   2.98e-6                  0 25;
         1 4  0.131   0.400      0   2.98e-6                  0 50;
         1 6  0.105   0.393      0   3.04e-6                  0 45;
         3 5  0.131   0.400      0   2.98e-6                  0 30;
         3 6  0.105   0.393      0   3.04e-6                  0 35;
         2 4  0.131   0.400      0   2.98e-6                  0 20;
         4 7  250     10.5      55     1.5                  1.0 50;
         6 9  410     10.5      98     1.5                  1.0 80;
         5 8  250     10.5      55     1.5                  1.0 50];

[nnl,mml]=size(line);
for i=1:nnl,
    if line(i,7)==0
        line(i,3)=line(i,3)*line(i,8)/Zb;
        line(i,4)=line(i,4)*line(i,8)/Zb;
        line(i,5)=line(i,5)*line(i,8)/Yb;
        line(i,6)=line(i,6)*line(i,8)/2/Yb;
    else
        Pk=line(i,3);
        Uk=line(i,4);
        P0=line(i,5);
        I0=line(i,6);
        Sn=line(i,8);
        line(i,3)=Pk/1000/Sn/Sn*Ub2*Ub2/Zb;
        line(i,4)=Uk/100/Sn*Ub2*Ub2/Zb;
        line(i,5)=P0/1000/Ub2/Ub2/Yb;
        line(i,6)=-I0/100*Sn/Ub2/Ub2/Yb;
        line(i,7)=(10.5/121)/(10/110);
    end
end

line=line(:,1:7);


% 故障参数
% 故障支路首端节点 故障支路末端短路 （距首端距离0-1）
fault = [
   4   1   0.5];
  

% 计算参数
% 是否平启动（1为是，0为否）
calcSettings = [
    1];

disp('测试系统：三机九节点测试系统');
disp('故障类型：三相短路故障');
disp('故障点：支路1-4正中');
disp('短路电阻：0');
disp('计算类型：平启动');